# CDC控制系统 - 用户指南

## 目录
1. [快速入门](#快速入门)
2. [界面介绍](#界面介绍)
3. [设备连接](#设备连接)
4. [电机控制](#电机控制)
5. [传感器监控](#传感器监控)
6. [数据记录](#数据记录)
7. [数据可视化](#数据可视化)
8. [日志查看](#日志查看)
9. [高级功能](#高级功能)
10. [常见问题](#常见问题)

## 快速入门

### 首次使用步骤

1. **启动软件**
   - 双击桌面图标或从开始菜单启动

2. **连接设备**
   - 将CDC设备通过USB连接到电脑
   - 等待系统识别设备（约3-5秒）

3. **添加设备**
   - 点击"Serial Communication"标签
   - 点击"Add Device"按钮
   - 选择正确的COM端口
   - 设置波特率（默认115200）
   - 点击"OK"

4. **开始测量**
   - 切换到"Motor Control"设置位置
   - 切换到"Sensor Monitor"查看数据
   - 点击"Record Data"记录数据

## 界面介绍

### 主窗口布局

```
┌─────────────────────────────────────────┐
│  菜单栏                                  │
├─────────────────────────────────────────┤
│  ┌──────────────────────────────────┐  │
│  │ 标签页：                          │  │
│  │ [通信][电机][传感器][日志][可视化]│  │
│  └──────────────────────────────────┘  │
│  ┌──────────────────────────────────┐  │
│  │                                   │  │
│  │        功能区域                   │  │
│  │                                   │  │
│  └──────────────────────────────────┘  │
├─────────────────────────────────────────┤
│  状态栏                                  │
└─────────────────────────────────────────┘
```

### 功能页面

1. **Serial Communication** - 串口通信管理
2. **Motor Control** - 电机控制
3. **Sensor Monitor** - 传感器监控
4. **Log Viewer** - 日志查看
5. **Data Visualization** - 数据可视化

## 设备连接

### 添加新设备

1. **打开添加设备对话框**
   - 点击"Add Device"按钮
   
2. **填写设备信息**
   - **Device Name**: 给设备起个名字（如"CDC-01"）
   - **Port**: 选择COM端口
   - **Baud Rate**: 选择波特率
     - 9600（慢速，稳定）
     - 115200（推荐）
     - 230400（高速）

3. **测试连接**
   - 点击"Test"按钮验证连接
   - 成功会显示"Connection successful"

### 管理设备

#### 连接设备
1. 在设备列表中选择设备
2. 点击"Connect"按钮
3. 状态变为绿色表示连接成功

#### 断开设备
1. 选择已连接的设备
2. 点击"Disconnect"按钮

#### 删除设备
1. 选择要删除的设备
2. 点击"Remove Device"
3. 确认删除

### 发送自定义命令

1. 在底部命令框输入命令
2. 点击"Send"或按Enter
3. 在通信日志中查看响应

## 电机控制

### 基本操作

#### 设置目标位置
1. **设置高度**
   - 输入目标高度（0-100mm）
   - 点击"Set Height"

2. **设置角度**
   - 输入目标角度（-90°到90°）
   - 点击"Set Angle"

3. **执行移动**
   - 点击"Move to Position"
   - 电机开始移动到目标位置

#### 预设位置

- **Home Position**: 回到原点（0mm, 0°）
- **Stop Motor**: 立即停止当前运动

### 安全设置

#### 设置限位
1. **高度限位**
   - Min Height: 最小高度（默认0mm）
   - Max Height: 最大高度（默认100mm）

2. **角度限位**
   - Min Angle: 最小角度（默认-90°）
   - Max Angle: 最大角度（默认90°）

#### 紧急停止
- 点击红色"EMERGENCY STOP"按钮
- 立即停止所有运动
- 需要重新连接才能继续操作

### 状态监控

- **Current Height**: 当前高度位置
- **Current Angle**: 当前角度位置
- **Theoretical Capacitance**: 理论电容值
- **Motor Status**: 电机状态
  - Ready: 就绪
  - Moving: 运动中
  - Error: 错误
- **Connection Status**: 连接状态

## 传感器监控

### 实时数据显示

#### Primary Measurements（主要测量）
- **Board Distance**: 板间距离
- **Board Angle**: 板倾斜角度
- **Temperature**: 环境温度

#### Capacitance Data（电容数据）
- **Measured**: 实测电容值
- **Theoretical**: 理论计算值
- **Difference**: 误差值

#### Detailed Sensor Data（详细传感器数据）
- **Upper Sensors**: 上方两个距离传感器
  - Corner1: 角1距离
  - Corner2: 角2距离
- **Lower Sensors**: 下方两个距离传感器
  - Corner1: 角1距离
  - Corner2: 角2距离
- **Calculated Values**: 计算值
  - Average Height: 平均高度
  - Calculated Angle: 计算角度
  - Average Ground Distance: 平均对地距离

### 数据更新

- 数据每2秒自动更新
- 绿色指示灯表示数据正常
- 红色指示灯表示数据异常

## 数据记录

### 记录数据点

1. **手动记录**
   - 调整到目标位置
   - 等待数据稳定
   - 点击"Record Data"
   - 显示"Last Recorded"时间戳

2. **记录内容**
   - 时间戳
   - 设定值（高度、角度）
   - 传感器原始数据
   - 计算值
   - 环境参数

### 导出数据

1. **导出为CSV**
   - 点击"Export"按钮
   - 选择保存位置
   - 输入文件名
   - 点击"保存"

2. **CSV格式**
   ```csv
   Timestamp,Set_Height,Set_Angle,Measured_Cap,Theoretical_Cap,...
   2025-01-20 14:23:45,50.0,0.0,156.7,158.2,...
   ```

## 数据可视化

### 加载数据

1. **从CSV文件**
   - 选择"CSV File"数据源
   - 点击"Load CSV"
   - 选择CSV文件

2. **从当前记录**
   - 选择"Real-time Data"
   - 自动加载当前会话数据

### 图表类型

#### 1. Distance-Capacitance Analysis
- **用途**: 分析距离与电容的关系
- **固定条件**: 角度和温度
- **X轴**: 距离(mm)
- **Y轴**: 电容(pF)

#### 2. Angle-Capacitance Analysis
- **用途**: 分析角度与电容的关系
- **固定条件**: 高度和温度
- **X轴**: 角度(°)
- **Y轴**: 电容(pF)

#### 3. 3D Distance-Angle-Capacitance
- **用途**: 三维关系分析
- **X轴**: 距离(mm)
- **Y轴**: 角度(°)
- **Z轴**: 电容(pF)
- **颜色**: 温度(°C)
- **交互**: 
  - 鼠标拖动旋转
  - 滚轮缩放

#### 4. Temperature Compensation
- **用途**: 温度补偿分析
- **X轴**: 温度(°C)
- **Y轴**: 电容(pF)

#### 5. Measurement Error Analysis
- **用途**: 误差分析
- **显示**: 理论值vs实测值
- **统计**: R²、RMSE、最大误差

### 图表设置

#### 显示选项
- **Show Grid**: 显示网格线
- **Auto Scale**: 自动缩放
- **Range**: 手动设置范围

#### 统计信息
- **Data Points**: 数据点数
- **R² Value**: 相关系数
- **RMSE**: 均方根误差
- **Max Error**: 最大误差
- **Mean Error**: 平均误差

### 图表交互

- **缩放**: 滚轮或双指缩放
- **平移**: 按住鼠标左键拖动
- **重置**: 双击重置视图
- **数据点**: 悬停显示详细信息

## 日志查看

### 日志级别

- **All**: 显示所有日志
- **Info**: 信息级别
- **Warning**: 警告信息
- **Error**: 错误信息

### 日志操作

1. **筛选日志**
   - 从下拉菜单选择级别
   - 自动过滤显示

2. **清空日志**
   - 点击"Clear Log"
   - 确认清空

3. **保存日志**
   - 点击"Save Log"
   - 选择保存位置
   - 保存为.txt或.log文件

### 日志内容

- 系统启动/关闭
- 设备连接/断开
- 命令发送/接收
- 错误和警告
- 用户操作记录

## 高级功能

### 批量测量

1. **设置测量序列**
   - 定义高度范围和步进
   - 定义角度范围和步进

2. **自动测量**
   - 系统自动移动到各个位置
   - 自动记录数据
   - 完成后自动导出

### 数据分析

1. **回归分析**
   - 自动计算线性回归
   - 显示拟合方程
   - 计算R²值

2. **误差分析**
   - 计算系统误差
   - 识别异常点
   - 生成误差报告

### 校准功能

1. **传感器校准**
   - 零点校准
   - 增益校准
   - 温度补偿

2. **系统校准**
   - 机械零点设置
   - 行程校准

## 常见问题

### Q: 设备无法连接？
**A:** 
- 检查USB线缆连接
- 确认COM端口正确
- 尝试不同的波特率
- 重启设备和软件

### Q: 数据不更新？
**A:** 
- 检查连接状态
- 查看日志中的错误信息
- 确认传感器工作正常

### Q: 电机不移动？
**A:** 
- 检查安全限位设置
- 确认没有触发紧急停止
- 查看电机状态

### Q: 3D图表不显示？
**A:** 
- 确认显卡支持OpenGL 3.3+
- 更新显卡驱动
- 尝试2D图表模式

### Q: 导出数据失败？
**A:** 
- 检查磁盘空间
- 确认有写入权限
- 关闭其他打开该文件的程序

## 快捷键

- **Ctrl+O**: 打开文件
- **Ctrl+S**: 保存数据
- **Ctrl+E**: 导出数据
- **Ctrl+Q**: 退出程序
- **F1**: 帮助
- **F5**: 刷新数据
- **Space**: 紧急停止
- **Esc**: 取消操作

## 最佳实践

1. **测量准备**
   - 预热设备10分钟
   - 检查环境温度稳定
   - 清洁传感器表面

2. **数据采集**
   - 每个位置等待3-5秒稳定
   - 重复测量3次取平均
   - 记录环境条件

3. **数据管理**
   - 定期导出数据备份
   - 使用有意义的文件名
   - 记录实验条件

4. **维护保养**
   - 定期清洁传感器
   - 检查机械部件
   - 更新软件版本

## 技术支持

如需帮助，请联系：
- 📧 Email: support@example.com
- 📞 电话: +49 89 289 xxxxx
- 🌐 网站: https://www.example.com
- 📖 文档: https://docs.example.com